import org.gradle.internal.os.OperatingSystem

nativeUtils.addWpiNativeUtils()
nativeUtils.withRoboRIO()

nativeUtils {
  wpi {
    configureDependencies {
      wpiVersion = "2020.+"
      niLibVersion = "2020.7.1"
      opencvVersion = "3.4.7-2"
      googleTestVersion = "1.9.0-3-437e100"
    }
  }
}

nativeUtils.wpi.addWarnings()
nativeUtils.wpi.addWarningsAsErrors()

nativeUtils.setSinglePrintPerPlatform()

nativeUtils.configurePlatform(nativeUtils.wpi.platforms.roborio) {
  cCompiler.args << '-std=c11' << '-Wno-strict-aliasing'
  cCompiler.args.remove('-pedantic')
}

model {
    components {
        all {
            targetPlatform nativeUtils.wpi.platforms.roborio
        }
    }
    // Uncomment this, and remove above lines to enable builds for all platforms
    // components {
    //     all {
    //         nativeUtils.useAllPlatforms(it)
    //     }
    // }
    binaries {
        withType(NativeBinarySpec).all {
            nativeUtils.usePlatformArguments(it)
        }
    }
}
